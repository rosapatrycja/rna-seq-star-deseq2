pdf('qc/rseqc/ML.DmBG3.c2.122-rep1.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,281,282,283,284,285,286,287,288,289,290,291,292,293,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,314,315,316,317,318,319,321,322,323,324,325,326,329,330,331,332,334,335,336,337,338,339,340,342,344,345,346,347,348,349,351,353,355,358,359,360,361,362,363,364,365,368,369,370,371,373,374,376,378,379,381,382,385,386,387,389,390,393,394,395,396,398,399,401,402,403,404,405,406,407,408,409,410,411,413,415,416,417,418,419,420,422,424,425,426,428,429,430,432,435,437,439,440,441,445,446,447,448,450,451,452,455,456,457,458,459,460,461,463,464,465,466,468,469,471,474,476,477,480,482,484,487,491,494,496,497,500,503,504,505,506,507,509,512,515,517,527,528,529,532,547,549,550,554,556,565,572,583,592,594,598,600,605,609,611,616,619,622,627,629,630,633,637,639,645,647,648,649,651,658,660,661,662,663,672,684,686,687,689,700,705,709,722,726,741,742,758,776,781,786,792,810,817,827,857,883,902,905,927,941,948,954,968,974,985,1046,1061,1076,1089,1166,1167,1260,1285,1388,1409,1704,1706,1733,1760,2046,2080,2427,2480,2558,3197,3415,3840,4013,4254,7848,13422)
seq_uniqRead=c(2859394,384934,136533,65705,37411,24045,16343,11862,9209,7163,5963,4758,4045,3428,2969,2590,2201,2069,1795,1649,1498,1340,1186,1114,1033,938,902,808,754,749,660,610,621,559,518,499,461,468,469,378,422,392,369,349,317,310,282,275,279,294,264,253,251,226,228,235,227,196,167,181,180,171,159,173,168,133,136,164,150,143,116,131,131,102,107,111,135,117,104,108,117,95,90,77,76,67,78,89,83,68,83,67,67,51,51,69,58,49,51,69,57,55,44,43,48,45,41,44,37,36,39,36,42,33,38,37,48,31,35,25,25,36,35,28,37,22,35,31,26,21,21,26,23,25,23,23,31,32,22,24,26,27,18,18,18,16,20,20,19,29,17,16,26,10,18,12,25,11,15,13,12,22,22,14,17,10,19,10,18,19,11,11,10,12,9,11,8,20,10,12,15,13,10,11,11,9,7,5,9,4,10,14,11,12,6,8,8,7,3,7,5,8,10,6,4,9,8,10,2,1,5,5,10,6,6,3,12,6,4,5,10,10,4,4,4,9,10,3,5,2,3,5,4,4,3,8,5,1,3,4,4,5,3,5,2,6,4,3,4,2,4,1,2,2,5,5,4,10,6,7,4,3,4,3,9,2,2,3,4,6,2,7,9,3,6,4,3,3,2,1,2,3,5,6,3,2,2,3,2,3,1,2,1,8,1,1,2,2,3,2,2,3,1,1,5,1,3,2,3,1,1,1,1,3,2,3,1,1,3,2,1,4,2,1,1,3,1,5,2,3,1,4,1,1,1,2,1,2,2,1,1,4,4,2,1,1,2,1,2,1,1,1,1,1,2,2,1,1,3,1,2,1,3,1,1,1,3,3,1,1,3,1,2,1,1,1,1,1,1,2,4,2,1,1,1,1,1,3,1,2,3,3,2,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,3,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,2,1,4,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,344,346,347,348,349,351,352,353,355,356,357,358,359,360,361,362,363,364,366,368,370,371,372,373,374,375,376,377,378,379,380,382,383,384,385,387,388,389,390,391,393,394,395,397,398,400,401,402,403,404,405,406,408,409,410,411,412,416,417,418,420,422,423,427,428,429,430,431,432,434,436,438,439,441,442,444,445,446,449,451,454,455,457,459,460,461,463,464,465,466,467,468,469,472,476,477,480,481,482,483,484,485,487,491,492,495,496,498,499,502,503,504,507,509,510,511,513,516,517,519,520,522,523,524,525,527,529,533,537,543,545,547,548,555,556,559,561,562,563,564,568,570,571,575,577,578,582,586,587,590,591,593,595,597,602,603,604,605,616,628,632,635,637,641,645,649,652,660,662,665,675,680,684,687,690,701,708,710,713,714,718,720,724,725,730,731,733,734,745,746,750,751,757,771,774,783,790,791,794,799,809,837,843,853,862,869,886,897,903,923,943,953,997,1008,1024,1036,1037,1063,1078,1084,1090,1143,1180,1221,1241,1245,1294,1377,1410,1504,1555,1606,1872,1882,1926,1954,2241,2343,2706,2776,2920,3668,3877,4246,4522,4695,8654,15315)
pos_uniqRead=c(2071859,424855,158029,77614,44499,28823,19645,14381,10776,8625,6902,5734,4715,4097,3469,3020,2622,2387,2075,1957,1759,1538,1436,1320,1220,1078,1012,993,873,801,818,704,690,623,652,572,518,542,497,479,456,458,407,367,380,404,352,342,321,286,299,323,280,249,272,256,235,229,216,208,224,206,199,211,202,158,175,163,173,166,163,136,136,158,145,131,117,153,132,115,121,111,108,122,111,83,97,86,99,111,102,102,93,73,79,68,72,81,70,80,75,54,85,59,64,53,70,53,47,41,44,50,50,38,51,45,46,52,46,55,45,47,31,43,39,35,31,35,39,29,26,31,33,37,31,32,21,28,30,33,28,28,30,23,22,22,23,22,31,25,21,18,21,19,22,22,29,20,23,26,23,21,14,21,19,16,17,18,21,14,20,15,16,16,12,14,13,21,12,12,14,19,13,12,23,16,21,12,12,21,11,15,9,13,8,9,14,11,16,17,15,7,8,13,6,7,6,10,7,10,9,9,10,9,9,8,3,2,7,9,11,10,9,3,11,4,7,6,7,7,4,4,7,6,4,5,4,7,9,5,5,6,5,8,6,4,2,6,3,6,8,4,5,7,9,4,5,7,2,10,5,2,8,2,3,5,2,5,5,8,5,3,6,3,2,4,3,4,3,1,1,8,3,4,3,1,6,6,6,1,2,2,8,4,2,2,4,7,4,3,2,3,6,5,4,7,5,4,3,4,6,3,3,1,3,2,2,3,4,2,2,3,1,2,2,2,1,1,2,3,7,4,1,1,3,2,5,3,3,1,3,5,2,1,2,1,3,1,3,4,3,2,3,1,3,1,4,1,3,1,1,1,2,2,4,1,2,1,2,2,3,2,3,3,1,2,2,1,1,1,1,2,1,1,2,1,1,3,2,1,1,1,2,4,3,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,3,1,1,2,1,2,2,3,2,1,1,2,1,2,3,2,1,1,1,2,1,1,1,1,2,4,5,1,1,2,2,1,3,1,1,2,2,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,3,2,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
