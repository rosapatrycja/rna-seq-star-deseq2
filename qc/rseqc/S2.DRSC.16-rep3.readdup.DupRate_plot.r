pdf('qc/rseqc/S2.DRSC.16-rep3.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,361,362,363,364,366,367,368,369,371,372,374,376,377,378,379,380,382,383,384,385,386,387,388,389,390,391,392,393,395,396,397,398,399,400,403,405,406,407,408,409,410,411,412,413,414,415,416,422,423,425,428,429,433,434,435,436,437,438,439,440,441,442,443,445,446,447,448,449,451,452,455,458,459,460,465,468,469,471,473,474,475,478,479,482,483,485,487,491,493,496,500,503,504,505,506,507,514,515,516,517,520,521,525,529,531,535,540,544,546,550,555,557,558,559,561,562,570,573,585,589,590,595,601,604,607,608,609,610,620,629,634,635,657,664,665,670,673,684,689,690,694,698,701,711,718,721,725,731,736,756,775,794,808,813,819,834,836,838,848,854,859,861,868,881,889,900,901,923,924,949,951,966,967,998,999,1010,1027,1030,1077,1086,1134,1218,1245,1263,1268,1303,1304,1329,1410,1422,1449,1512,1564,1588,1623,1706,1837,1921,2358,2473,2489,2615,3720,4585,4596,5815,15669)
seq_uniqRead=c(4062317,494093,169551,78394,43044,26874,18190,13035,9651,7501,6002,5116,4183,3475,2977,2618,2337,2123,1970,1622,1594,1397,1352,1159,1064,1054,931,920,856,803,756,662,656,603,601,602,549,494,523,480,436,464,400,382,385,387,385,322,307,280,279,317,262,276,287,220,252,228,202,233,209,206,200,200,211,203,184,159,151,176,140,124,151,150,138,124,154,161,120,117,112,120,124,106,105,100,93,103,105,102,91,68,88,85,98,96,71,86,84,76,75,82,70,68,60,66,60,76,67,64,68,69,50,67,43,47,53,43,56,51,47,41,51,58,51,41,43,44,39,43,39,42,39,36,33,32,32,29,43,20,32,39,37,23,36,29,25,31,29,22,35,31,28,28,25,31,23,27,24,17,14,18,17,16,18,29,19,19,16,26,30,14,12,21,19,23,11,22,21,12,21,17,14,8,11,9,16,9,14,13,19,16,14,16,9,16,11,14,19,15,9,6,16,16,8,12,8,8,8,10,7,8,13,12,9,13,8,12,6,7,9,14,9,6,8,8,3,6,9,11,9,7,5,5,7,11,5,2,6,4,4,7,8,3,7,7,7,3,6,4,11,6,7,6,4,4,3,7,3,6,8,11,3,6,5,2,4,4,5,7,5,2,2,6,7,3,6,1,4,3,2,5,3,8,4,6,3,5,3,1,2,1,1,4,2,2,5,3,1,6,4,4,2,1,5,5,1,4,3,2,3,4,3,1,4,5,4,3,3,2,2,3,1,4,1,2,3,2,1,2,2,4,1,2,2,1,5,2,1,1,6,1,5,5,1,3,1,2,1,3,2,1,1,2,3,3,3,1,1,1,2,3,3,2,2,1,1,1,1,3,1,1,2,3,1,1,4,1,3,4,4,1,1,2,2,1,3,2,1,1,2,6,3,1,2,1,2,4,2,1,1,3,3,2,2,1,1,1,1,2,2,1,2,2,2,2,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,2,2,1,1,1,1,1,2,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,323,324,325,326,327,328,329,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,358,359,360,361,362,365,366,368,369,370,371,372,373,374,375,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,395,396,397,398,399,400,401,402,403,404,406,407,408,410,411,414,415,416,418,419,420,422,423,424,425,426,427,428,429,431,432,433,435,436,437,438,439,441,442,443,444,445,446,447,448,449,450,451,453,454,455,456,458,459,460,462,463,465,466,469,470,471,472,474,475,476,477,478,479,480,481,484,486,487,488,489,491,494,496,497,499,500,501,503,505,507,508,511,512,513,516,517,520,521,523,524,525,527,528,530,532,534,536,537,539,541,544,545,546,547,550,551,552,553,556,557,560,561,562,565,566,567,569,571,574,575,576,578,581,582,583,590,592,593,594,595,597,598,599,600,603,606,608,610,612,617,622,623,629,634,636,637,640,657,659,666,668,669,683,692,693,695,700,705,723,724,731,736,751,761,765,785,787,789,793,797,801,807,808,813,814,834,841,844,851,852,857,862,870,873,890,892,901,904,905,913,926,928,946,950,956,957,975,997,1019,1021,1027,1037,1056,1059,1065,1115,1121,1127,1131,1144,1188,1201,1203,1306,1338,1358,1417,1446,1489,1493,1507,1511,1549,1561,1600,1647,1747,1906,1963,2008,2018,2142,2650,2707,2799,2917,3076,4269,5068,5410,6725,18167)
pos_uniqRead=c(2792520,560489,205152,97144,54930,34195,23156,16628,12615,9338,7849,6321,5205,4425,3800,3205,2915,2613,2299,2011,1888,1718,1575,1406,1362,1263,1166,1083,1029,942,895,826,754,731,702,698,654,606,586,559,516,534,493,455,450,465,408,398,436,375,339,358,329,340,324,287,287,289,269,271,271,240,236,245,217,224,206,202,212,217,197,194,193,183,168,173,170,154,168,155,139,153,137,150,116,128,149,150,112,133,128,113,103,111,98,107,88,88,100,92,82,83,105,96,96,82,79,86,81,81,79,84,79,60,64,95,67,73,79,70,82,63,61,62,59,49,46,59,50,56,60,52,44,50,44,50,50,52,49,48,34,47,52,47,52,36,43,41,37,31,42,36,42,29,35,34,31,28,36,40,35,29,34,32,32,26,29,28,24,24,23,28,33,26,27,23,31,20,19,20,27,26,23,28,22,18,21,19,21,19,24,21,24,17,22,17,15,15,20,24,17,18,12,11,24,14,23,13,18,13,21,10,12,11,13,9,16,10,11,14,5,18,12,10,13,6,10,12,10,13,12,16,21,19,10,8,16,9,12,9,11,9,7,12,5,9,10,8,10,8,11,11,12,8,5,7,8,6,5,4,6,7,12,4,12,5,7,6,12,7,4,6,10,5,8,12,7,2,11,7,5,6,9,5,2,9,8,10,7,4,6,5,7,8,7,2,5,12,6,6,2,6,4,3,7,2,2,2,5,5,8,6,1,7,4,7,3,5,5,4,4,5,2,6,5,4,4,4,1,5,2,3,3,1,6,3,7,4,5,2,5,3,1,3,2,2,4,3,4,2,1,4,3,4,8,1,1,3,1,5,3,2,3,3,3,3,1,2,4,1,1,3,2,1,4,1,4,4,3,4,1,2,1,4,2,3,1,3,3,3,3,2,6,3,4,2,3,1,1,1,2,1,3,1,1,1,3,3,1,3,1,5,1,2,1,2,2,3,2,2,5,3,2,1,2,1,1,2,2,2,2,3,2,1,2,2,1,1,1,2,3,2,3,1,4,1,1,1,2,2,1,2,2,4,1,3,4,2,4,1,1,4,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,2,1,1,2,1,1,1,1,2,2,1,2,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,2,1,1,1,1,2,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
