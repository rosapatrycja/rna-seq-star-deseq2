pdf('qc/rseqc/S2.DRSC.14-rep1.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,427,428,429,430,431,432,433,435,436,437,438,439,440,441,442,443,444,446,449,452,454,455,456,457,458,459,461,463,464,465,466,467,468,469,471,472,473,474,475,477,478,479,482,483,484,485,486,487,488,490,491,492,493,494,496,497,498,499,500,502,503,504,506,507,508,510,511,512,514,515,516,517,518,520,521,522,523,525,526,527,528,529,530,531,532,533,534,535,536,538,539,540,541,542,543,544,545,548,549,552,553,554,555,557,558,559,560,562,563,564,570,571,573,574,577,578,583,585,586,587,588,589,590,592,593,594,596,603,605,608,609,611,616,617,618,621,623,624,625,629,632,639,641,642,649,652,653,655,659,666,670,672,675,676,677,679,680,686,697,701,702,707,708,709,712,716,722,723,727,744,746,747,748,749,751,754,756,759,763,768,776,777,778,784,785,788,790,796,801,804,807,832,835,836,873,886,894,899,902,903,906,909,912,917,919,933,934,949,962,970,976,979,994,997,1013,1028,1037,1041,1047,1057,1074,1075,1077,1086,1091,1127,1132,1137,1178,1195,1208,1227,1252,1281,1290,1291,1326,1327,1353,1388,1419,1421,1427,1434,1478,1488,1496,1523,1539,1569,1580,1685,1695,1846,1855,1881,1987,2012,2230,2551,2628,2825,4896,5189,5565,5863,15592)
seq_uniqRead=c(4375635,624143,233919,113571,64900,40757,27810,19634,14684,11354,8997,7433,6101,5156,4192,3696,3379,2872,2634,2327,2169,1925,1741,1553,1475,1318,1277,1102,1049,1004,931,895,869,821,792,679,653,711,625,658,608,556,552,507,474,465,481,425,448,435,389,406,359,375,365,339,367,319,295,331,269,283,279,282,260,249,236,227,244,222,224,228,209,206,202,185,222,185,174,203,170,160,160,176,163,151,147,138,133,156,125,151,146,154,131,115,118,109,123,117,110,97,94,111,117,95,108,90,93,103,89,100,101,81,89,83,74,73,85,70,89,66,77,80,63,79,77,69,74,61,86,58,65,52,71,63,45,61,54,50,70,55,62,62,58,45,56,57,43,40,33,44,47,50,40,42,49,40,55,50,35,43,45,37,41,40,44,30,39,33,36,48,36,27,46,25,33,20,35,34,31,32,31,22,28,24,30,32,30,32,19,26,28,21,20,24,35,20,25,36,27,39,27,25,26,24,15,17,18,21,22,24,24,23,17,27,13,18,13,25,29,20,11,27,18,20,20,22,17,21,18,12,15,10,14,15,14,17,17,10,13,24,8,10,8,16,13,15,16,9,7,17,14,10,11,11,10,8,8,10,13,13,10,15,13,16,15,5,5,6,9,12,14,10,10,5,12,8,5,10,7,10,8,11,6,9,4,6,10,9,10,11,9,2,8,6,10,8,10,5,11,2,3,14,17,6,10,5,5,8,8,7,8,4,6,5,6,11,4,10,4,10,6,6,5,7,3,3,13,3,8,3,4,5,9,1,8,7,4,7,3,7,4,4,3,4,4,6,8,7,4,5,4,2,5,4,1,4,5,2,4,1,3,9,7,2,3,2,5,3,6,2,7,2,3,4,4,3,5,3,4,5,4,2,2,3,6,2,1,1,4,2,3,3,6,9,5,1,3,3,3,2,1,3,5,3,1,1,4,6,2,4,3,2,3,2,3,2,1,2,3,1,3,2,4,2,3,2,2,1,5,2,2,2,1,3,4,5,2,2,3,3,1,1,1,1,1,2,1,1,1,3,2,2,1,3,1,1,2,2,2,1,3,1,1,2,2,3,2,1,4,1,2,3,3,1,3,1,1,2,3,1,1,1,2,3,3,1,3,2,1,1,2,1,1,1,2,1,2,1,1,1,1,1,2,3,3,1,1,2,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,4,2,2,1,1,2,1,2,1,1,1,2,1,2,1,2,1,1,1,1,3,1,2,1,1,2,2,1,3,1,1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,2,1,1,2,1,2,2,1,1,1,1,1,1,1,1,2,1,2,2,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,418,419,420,421,422,423,424,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,461,462,463,464,465,466,467,468,469,470,471,472,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,497,500,501,502,503,505,506,507,508,509,510,511,512,513,514,515,516,517,518,522,523,527,528,529,531,532,533,535,536,538,540,541,547,549,550,551,552,553,554,555,556,557,558,559,560,561,562,564,565,567,568,569,571,572,574,575,576,577,578,579,582,583,585,586,588,589,591,592,593,594,595,597,599,600,604,605,608,609,610,611,613,615,617,618,620,621,623,624,626,627,628,632,633,635,636,642,643,646,647,650,651,654,655,656,658,659,663,664,665,667,670,672,673,674,675,679,681,682,683,684,686,690,691,693,694,697,698,700,709,710,714,715,716,717,718,721,725,731,735,736,737,738,740,741,743,744,746,747,748,750,753,754,756,759,772,777,783,785,791,792,796,800,802,811,815,818,821,829,830,832,835,836,845,849,850,853,859,868,869,870,877,881,884,886,889,895,896,899,903,905,911,916,922,924,925,931,958,991,1005,1013,1019,1020,1033,1039,1041,1043,1044,1054,1057,1065,1067,1077,1088,1089,1090,1097,1110,1123,1125,1129,1138,1161,1180,1200,1204,1213,1228,1234,1237,1271,1277,1288,1307,1362,1405,1428,1457,1467,1513,1534,1544,1551,1591,1609,1657,1668,1672,1709,1724,1784,1802,1851,1874,1894,1986,2022,2041,2081,2166,2168,2205,2475,2796,2947,3093,5514,5768,6166,6590,17810)
pos_uniqRead=c(2916043,671947,268362,134276,77622,49186,33841,24131,18004,14004,10965,9229,7447,6218,5410,4598,3953,3411,3093,2781,2455,2336,2028,1923,1815,1656,1529,1348,1244,1275,1079,1049,978,936,855,870,781,745,737,677,650,638,638,620,561,539,492,512,509,497,475,442,406,368,406,393,385,359,365,343,336,312,338,333,347,295,310,297,239,290,247,251,221,243,263,234,226,206,198,215,208,192,188,207,196,164,180,185,165,175,163,166,177,162,151,148,142,127,147,146,124,114,116,122,134,120,102,107,128,123,102,103,115,98,113,89,93,96,89,94,96,95,103,99,90,72,98,94,87,92,66,72,81,71,78,77,82,73,72,75,62,54,69,82,70,67,67,59,61,64,53,72,54,50,68,47,47,55,70,60,52,42,55,38,69,47,54,47,39,42,35,43,40,38,40,35,38,40,49,33,31,45,42,41,44,37,39,36,35,36,31,35,32,34,36,39,45,33,28,31,33,28,26,33,34,23,27,29,35,33,20,26,28,25,23,25,23,21,34,21,22,26,17,23,25,29,24,21,16,23,21,14,16,21,23,9,18,21,22,22,27,14,14,17,28,17,21,32,11,21,23,17,22,12,16,16,10,14,15,16,17,16,17,23,17,18,16,14,17,9,15,16,16,12,17,9,10,24,24,12,10,11,7,13,11,9,19,10,12,12,11,16,6,16,17,17,14,7,11,11,9,6,11,18,9,4,8,9,10,5,9,10,9,7,7,6,8,7,9,11,9,8,7,6,7,7,7,6,5,8,5,8,5,8,5,7,5,6,6,6,12,7,13,7,6,10,5,3,7,11,8,4,9,10,6,10,4,7,9,7,7,4,3,8,7,3,3,6,7,10,9,4,6,6,6,12,9,7,5,1,6,4,10,8,6,2,2,3,9,5,6,3,3,6,2,2,4,4,3,4,4,4,3,3,6,8,5,4,5,4,2,4,4,4,1,4,6,2,4,6,1,2,2,3,2,6,4,5,2,8,1,4,5,3,1,4,2,3,5,4,1,3,1,5,2,5,4,3,5,2,3,4,3,5,3,6,6,3,2,2,2,2,2,5,2,3,4,2,3,2,4,4,1,4,4,3,2,2,2,4,5,2,2,1,1,4,4,1,2,1,1,6,3,3,1,2,3,1,2,3,3,1,1,2,2,1,2,4,3,2,1,3,2,3,4,1,1,2,2,1,1,2,1,2,1,2,1,1,2,4,2,1,3,1,1,1,1,2,2,3,1,1,2,5,2,1,1,3,4,1,3,1,2,1,2,2,3,1,1,2,1,3,1,4,1,2,1,1,2,2,1,2,4,1,2,1,1,1,1,1,1,1,1,2,1,1,1,2,2,2,1,1,1,1,2,1,1,2,1,1,1,3,2,2,1,2,1,2,2,1,2,1,1,1,1,1,1,2,3,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
