pdf('qc/rseqc/S2.DRSC.16-rep1.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,381,382,383,385,386,387,388,390,391,392,393,394,395,397,399,400,401,402,403,404,406,407,408,409,410,411,412,413,415,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,448,449,450,451,452,453,454,455,456,457,458,461,462,463,464,465,469,470,471,472,473,474,475,478,479,481,482,483,484,485,486,487,488,489,491,492,493,495,496,500,501,502,504,505,513,514,515,518,519,520,521,522,523,524,526,528,529,534,535,538,542,544,549,552,553,558,563,568,573,575,576,578,580,581,586,587,589,592,593,594,595,598,602,604,610,611,612,616,622,634,635,643,644,647,648,653,657,662,667,669,676,677,680,682,685,689,700,701,707,712,719,721,724,728,730,747,752,755,757,765,767,772,775,776,779,782,803,814,816,823,842,843,848,855,857,870,877,887,900,921,929,932,939,940,954,957,958,962,965,970,984,996,1009,1012,1015,1021,1043,1064,1071,1083,1114,1127,1135,1139,1170,1281,1302,1352,1408,1470,1480,1501,1509,1542,1553,1570,1608,1687,1730,1756,1796,1945,2240,2498,2564,2695,2861,3955,4664,5051,5892,16681)
seq_uniqRead=c(4529747,582010,206481,98060,53967,34095,22697,16425,12120,9640,7660,6180,5160,4166,3792,3247,2809,2549,2241,2049,1826,1635,1522,1448,1332,1196,1099,1054,974,860,846,821,798,748,705,652,620,656,624,547,516,481,461,512,431,414,432,402,396,357,340,356,343,341,312,277,258,264,266,269,237,239,235,259,217,228,197,192,208,188,180,187,191,190,180,162,167,167,163,150,158,145,127,135,132,131,123,146,118,113,123,117,110,95,100,107,107,83,99,120,79,81,77,85,85,81,78,65,79,86,71,81,77,64,64,74,74,69,73,75,51,54,75,50,50,52,62,69,56,66,56,59,56,48,49,52,54,49,48,46,49,48,43,43,34,45,53,41,39,40,41,38,35,36,31,29,30,37,33,30,37,27,29,30,36,30,24,27,32,18,32,40,25,17,34,21,25,21,29,23,19,22,21,32,26,22,18,20,15,25,14,23,30,14,18,13,19,24,20,13,18,21,18,16,16,17,21,14,17,14,18,15,15,18,13,18,6,18,14,13,18,12,14,20,13,14,6,12,17,12,7,16,10,13,8,9,11,7,17,11,13,12,11,9,7,7,6,5,4,14,5,14,5,6,2,5,9,6,5,10,10,11,7,13,10,11,5,4,7,5,6,8,5,8,8,8,4,10,4,6,2,6,9,8,5,5,10,7,6,7,3,4,3,9,5,3,9,6,2,3,6,5,7,7,3,5,7,7,7,6,3,2,7,5,4,5,7,7,2,2,2,1,3,1,4,3,3,5,6,2,3,1,2,3,10,3,5,4,2,2,2,5,3,3,2,4,2,6,7,3,4,3,2,3,4,4,5,1,1,1,8,4,6,7,4,1,3,4,2,2,2,4,1,7,2,2,1,2,2,1,3,3,3,3,1,2,2,1,2,1,3,1,2,3,5,2,2,1,1,4,2,1,3,2,1,6,2,1,3,1,1,2,2,2,2,1,2,1,2,2,2,2,3,1,2,4,1,1,5,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,3,2,2,2,2,1,2,1,3,2,3,1,2,4,1,1,5,1,1,2,3,2,1,2,2,1,1,2,2,1,3,1,3,2,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,2,2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,371,372,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,400,401,402,403,404,405,406,407,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,435,436,437,438,439,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,468,469,470,471,472,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,493,494,496,497,499,500,501,502,503,506,507,508,509,510,511,512,513,514,515,516,518,519,520,521,523,524,525,526,527,528,529,531,533,534,536,537,538,542,543,546,547,548,550,551,552,553,555,556,561,564,565,566,567,569,570,571,576,578,579,580,581,583,584,585,587,590,591,592,594,597,599,600,604,607,613,614,617,618,619,620,621,623,626,629,633,634,635,638,639,645,648,650,652,653,656,660,661,664,665,666,670,681,684,687,690,691,697,699,700,707,708,711,715,718,723,726,727,728,730,734,735,736,743,761,762,773,777,778,781,784,787,790,792,794,799,801,802,805,808,815,826,840,854,862,871,872,875,877,906,909,911,913,915,916,921,923,935,937,945,961,962,971,974,988,996,1022,1027,1033,1035,1044,1046,1053,1061,1065,1067,1090,1112,1114,1124,1126,1131,1143,1169,1173,1177,1218,1238,1260,1267,1297,1357,1369,1372,1404,1430,1495,1620,1639,1684,1685,1710,1729,1745,1761,1813,1919,1935,1972,2036,2165,2218,2775,2862,3037,3099,3240,4462,5129,5820,6811,19057)
pos_uniqRead=c(3072179,647397,245581,119262,67819,42461,28563,20534,15407,11932,9511,7851,6364,5542,4551,4019,3524,3038,2756,2491,2205,2056,1832,1682,1555,1452,1351,1217,1204,1141,1019,962,928,871,772,792,757,697,664,630,636,598,567,555,540,495,468,497,449,411,414,392,390,382,366,350,368,375,341,307,316,303,288,291,270,238,236,261,243,216,228,224,200,191,195,196,206,199,169,177,174,162,177,167,170,149,169,135,167,165,160,134,142,128,127,132,126,130,106,109,120,139,107,106,103,116,106,101,104,99,91,81,99,83,86,100,96,91,94,80,67,67,67,64,76,74,77,57,79,70,56,67,65,53,49,60,61,52,65,69,52,59,53,49,69,58,44,42,52,46,57,45,62,53,54,43,58,41,44,51,49,44,41,45,42,37,35,43,37,41,37,33,37,44,30,36,26,32,42,19,36,39,27,21,30,28,44,31,22,30,27,22,27,27,33,26,27,33,27,20,22,22,15,29,16,27,26,27,19,20,25,32,19,16,20,22,19,23,20,13,9,19,19,19,15,24,25,18,22,15,20,11,16,12,20,15,10,12,16,14,19,14,16,17,22,13,16,14,17,12,10,16,16,5,12,21,14,17,6,10,9,9,12,15,13,8,10,5,11,9,17,13,9,9,9,8,12,13,9,10,12,8,6,8,6,8,12,7,8,13,5,7,7,9,10,7,8,8,4,7,10,12,9,7,11,3,2,8,7,2,11,5,6,7,5,10,3,4,7,5,5,4,5,3,7,8,10,9,6,4,4,6,7,5,7,6,4,4,3,6,5,5,4,7,2,5,6,5,9,5,8,5,4,9,5,3,4,3,4,4,2,2,5,6,1,7,5,4,5,4,3,3,4,2,3,7,3,6,2,2,2,8,7,4,3,2,4,3,3,1,5,9,3,2,4,1,2,4,6,2,3,3,6,1,3,2,4,5,3,4,3,3,3,2,3,6,2,2,1,2,4,2,3,6,3,4,2,4,5,2,2,2,5,2,4,1,2,3,3,1,3,3,3,1,2,2,1,3,1,1,1,3,2,4,2,2,4,3,4,1,2,3,1,1,2,1,2,3,1,1,4,4,3,4,1,1,3,3,1,1,3,2,3,1,4,2,2,2,1,3,1,2,1,1,2,2,3,2,1,2,3,2,3,4,2,1,3,2,1,1,2,1,1,1,1,1,1,1,1,3,1,2,2,1,2,1,1,3,1,1,1,1,1,2,2,2,1,1,1,1,2,2,1,3,2,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,3,1,1,1,1,3,1,1,1,1,2,1,1,2,1,2,1,2,1,1,2,1,1,2,2,1,1,2,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,2,2,1,1,2,1,1,1,1,1,1,2,1,1,1,1,3,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
