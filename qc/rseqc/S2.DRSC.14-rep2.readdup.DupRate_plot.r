pdf('qc/rseqc/S2.DRSC.14-rep2.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,337,338,339,340,341,342,343,344,346,347,348,349,350,351,352,353,354,355,356,357,358,360,361,362,363,364,365,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,393,395,396,397,398,400,402,405,406,407,408,409,410,411,412,414,415,416,418,419,420,422,424,425,427,428,429,430,431,433,437,439,441,443,444,445,448,451,452,453,456,457,459,460,461,463,465,466,467,469,470,471,472,473,474,476,477,478,480,482,487,489,493,497,501,502,503,506,507,512,514,515,516,521,527,528,529,530,531,534,538,539,540,545,546,552,556,557,561,563,564,569,570,571,575,576,577,579,591,594,595,599,611,613,615,627,640,645,660,663,684,686,691,692,694,696,698,704,710,712,720,724,726,729,732,737,739,744,753,761,765,770,778,791,817,837,846,848,849,850,853,857,890,926,932,951,1006,1024,1038,1044,1045,1054,1058,1078,1084,1161,1167,1182,1189,1191,1236,1240,1262,1263,1266,1289,1300,1342,1357,1431,1436,1466,1505,1549,1601,1661,1674,1703,1957,2379,2548,2691,4489,4881,5302,5560,14605)
seq_uniqRead=c(4227875,519271,183247,86498,48292,29769,19986,14320,10709,8373,6559,5410,4536,3882,3214,2897,2401,2244,1858,1747,1655,1485,1393,1288,1144,1050,965,951,905,825,765,766,677,665,607,601,563,554,525,531,453,460,455,414,386,394,384,357,352,321,316,301,309,287,298,228,244,286,233,233,240,220,229,223,215,201,182,194,183,182,174,165,153,163,162,160,147,147,151,130,139,108,123,123,129,111,114,117,96,115,102,92,97,86,108,90,75,108,112,78,61,77,70,88,82,78,54,63,62,62,49,68,74,60,62,63,69,73,38,57,48,64,51,44,37,55,48,56,56,46,43,34,48,41,38,45,39,38,37,47,26,36,40,43,34,21,32,42,27,37,38,30,21,33,24,33,33,32,33,24,19,31,27,40,26,28,20,27,29,27,30,18,22,19,17,26,19,21,18,21,18,20,20,18,22,17,9,22,16,12,14,14,22,14,16,17,18,13,14,11,12,9,13,9,9,15,14,17,13,10,9,11,19,11,20,7,8,7,11,12,6,9,9,13,3,9,9,3,10,9,7,11,9,8,4,5,13,10,6,6,5,11,4,7,7,14,7,4,11,6,2,3,9,7,6,6,7,6,7,4,3,4,10,8,4,10,8,5,3,6,6,9,3,4,3,10,4,7,3,7,3,5,5,3,6,4,2,5,2,6,5,5,3,2,2,4,5,6,6,6,3,3,9,2,2,4,1,3,5,6,6,4,5,2,1,6,9,1,2,1,2,4,1,5,5,4,1,5,4,2,5,1,2,3,5,2,3,4,2,3,2,1,1,2,2,1,3,1,4,2,1,5,1,1,3,2,1,3,2,2,2,2,1,1,3,2,1,2,2,1,2,2,3,1,4,1,1,2,2,2,2,3,1,1,1,5,1,1,4,6,2,1,1,1,1,2,1,2,1,2,1,1,2,1,1,1,2,1,2,1,2,2,3,2,1,1,2,3,1,1,3,2,2,3,1,1,2,1,1,2,2,3,1,1,2,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,2,2,1,1,4,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,2,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,400,401,402,403,404,405,407,408,409,411,412,413,414,415,417,418,419,421,422,423,424,425,426,427,428,429,430,432,433,434,435,436,438,439,440,441,442,444,446,447,448,449,452,453,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,473,474,475,476,479,480,481,482,484,487,488,489,491,492,493,496,497,499,502,503,504,505,506,507,509,510,511,513,515,516,518,520,521,522,523,525,527,528,530,534,537,539,541,543,545,546,549,550,552,553,554,555,557,558,559,564,566,567,569,571,573,574,577,581,582,585,589,591,595,600,601,602,603,604,610,613,615,616,618,619,622,624,627,628,630,633,634,636,637,638,639,644,645,647,655,658,662,667,670,672,673,674,681,683,684,691,700,710,717,720,724,725,731,746,749,753,765,767,769,775,776,778,785,787,794,797,798,803,805,809,810,812,817,818,829,830,835,841,846,851,854,858,861,863,878,881,884,886,890,904,909,932,941,942,952,993,1008,1034,1037,1039,1045,1048,1049,1071,1072,1123,1127,1130,1154,1156,1157,1201,1214,1242,1248,1260,1321,1383,1418,1420,1464,1476,1515,1538,1611,1612,1627,1654,1657,1665,1736,1759,1833,1862,1864,1872,1906,2269,2705,3046,3093,5166,5559,6056,6377,17269)
pos_uniqRead=c(2708153,580797,222362,107951,61443,38616,26407,18773,13944,10915,8701,7016,5826,4891,4280,3705,3282,2762,2480,2226,2026,1830,1753,1542,1437,1314,1164,1143,1146,1024,968,847,852,791,791,719,702,676,595,595,554,521,536,532,501,468,466,412,403,405,388,388,376,376,340,326,346,307,286,287,282,255,269,267,266,247,233,249,215,232,188,224,197,205,206,185,185,218,200,148,174,158,158,154,137,162,154,144,129,133,136,140,128,139,119,108,109,97,120,115,104,105,109,108,104,90,85,106,89,97,85,92,89,83,77,79,79,80,76,79,68,76,77,74,72,55,56,82,75,61,59,69,56,67,65,45,50,55,48,55,54,63,48,56,46,45,47,38,46,35,51,46,30,40,38,48,39,34,36,38,29,43,42,32,26,35,33,31,35,31,36,35,41,21,34,34,30,27,23,26,46,23,33,25,24,23,30,29,20,31,24,27,28,27,13,24,26,25,23,32,24,13,21,18,23,23,15,19,14,20,26,25,18,20,18,22,15,13,16,14,23,17,12,9,15,13,13,16,20,18,13,16,16,11,11,13,19,15,13,18,16,17,19,14,11,14,10,17,12,6,10,11,4,10,11,12,9,7,11,15,6,11,6,4,9,7,9,5,5,13,14,7,12,10,9,12,7,7,10,9,12,8,6,1,6,9,8,9,10,6,4,6,6,8,10,9,2,5,5,1,5,10,3,7,6,9,5,6,8,5,4,3,7,4,6,5,7,6,5,5,5,1,5,5,6,6,8,6,8,4,5,2,5,10,3,6,8,4,8,6,1,6,6,4,6,1,3,2,3,2,4,5,2,3,1,2,7,7,5,1,3,3,4,5,3,3,3,2,7,4,2,3,4,5,2,1,4,5,4,5,5,4,1,2,2,1,2,1,3,6,1,3,3,1,3,4,1,3,2,1,5,3,3,3,1,7,3,4,4,3,3,2,4,1,1,1,4,1,2,1,7,2,3,1,4,2,4,2,2,2,3,3,2,2,1,1,1,2,1,3,1,3,1,1,2,2,3,3,2,1,2,1,2,3,2,2,1,2,1,2,3,1,1,2,3,1,2,3,2,3,1,1,1,1,1,2,1,2,2,1,1,1,2,1,1,1,3,1,1,1,2,2,1,1,1,1,1,1,1,2,1,2,2,1,4,2,2,1,1,1,1,3,3,1,1,1,1,1,2,2,3,1,2,1,2,1,2,1,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,1,1,1,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
