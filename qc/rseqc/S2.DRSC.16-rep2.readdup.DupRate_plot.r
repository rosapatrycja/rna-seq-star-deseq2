pdf('qc/rseqc/S2.DRSC.16-rep2.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,215,216,217,218,219,220,221,222,223,224,225,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,265,267,268,269,273,274,275,276,277,278,280,281,283,284,285,286,288,289,291,292,293,294,295,296,300,301,302,303,305,307,309,310,312,313,317,319,324,325,326,327,330,331,334,336,338,340,342,343,344,346,348,353,358,359,360,363,369,373,377,379,380,383,394,395,396,397,399,400,407,411,413,414,416,417,418,422,425,430,431,432,434,438,442,447,449,454,456,458,465,467,469,475,477,485,489,491,494,497,506,510,523,526,532,566,581,585,592,594,601,614,616,627,664,744,764,767,772,778,791,805,815,826,855,877,954,1026,1049,1139,1199,1235,1244,1295,1982,2169,2525,3105,7643)
seq_uniqRead=c(2752521,317216,100059,44788,24531,15433,10566,7575,5791,4618,3759,3219,2731,2348,2042,1757,1592,1454,1306,1174,1043,994,890,823,776,719,667,631,612,565,509,492,456,487,442,404,381,368,352,324,313,300,274,260,275,239,242,250,230,194,196,186,196,204,166,153,182,156,138,129,109,137,128,118,126,132,115,110,111,78,88,88,106,80,93,73,72,87,75,61,87,67,53,56,56,67,72,56,57,40,47,63,49,56,42,40,43,40,48,48,44,33,41,44,32,43,37,30,39,39,25,31,29,22,33,24,24,22,25,20,21,24,17,28,23,20,17,18,16,28,15,23,22,16,16,25,22,18,19,13,19,15,19,20,15,15,13,13,18,14,13,12,12,7,4,6,18,11,7,11,6,5,11,10,7,14,3,8,6,4,12,12,5,8,3,5,9,8,9,7,5,3,4,6,4,7,6,7,12,7,7,5,5,3,2,5,6,2,4,4,2,7,5,1,4,4,4,5,2,9,4,8,4,3,1,5,6,3,4,2,2,6,3,2,1,4,2,1,4,3,3,1,4,1,1,3,3,4,4,3,4,1,3,4,7,1,2,2,1,2,2,2,2,1,5,2,5,1,3,4,2,1,3,2,3,1,3,1,1,5,1,2,1,2,1,3,2,2,1,1,1,1,2,1,1,1,2,1,1,3,1,1,2,1,1,1,1,2,1,1,1,1,2,1,1,1,3,1,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,279,280,282,283,284,286,287,288,289,291,292,293,294,297,298,299,300,301,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,323,324,327,329,330,331,333,335,336,337,338,339,340,342,343,345,346,347,350,352,353,355,356,358,359,360,361,364,365,366,367,368,369,370,372,373,374,376,377,380,381,382,386,387,389,391,397,398,399,402,406,408,412,413,420,421,423,424,425,432,433,434,437,438,441,442,445,447,448,453,454,455,458,466,467,468,475,477,484,485,487,489,490,492,493,494,497,501,505,511,517,518,521,526,530,542,544,547,555,558,569,576,584,602,604,612,623,631,645,657,661,665,696,716,730,751,753,759,814,816,850,859,868,904,936,943,954,981,1026,1073,1077,1116,1349,1356,1420,1424,1626,2210,2421,2925,3586,9237)
pos_uniqRead=c(2021817,363173,122114,55455,30774,19315,13191,9526,7285,5710,4560,3865,3273,2663,2452,2179,1935,1639,1551,1428,1276,1166,1073,1038,929,863,804,735,680,666,595,582,591,514,523,484,431,417,445,374,416,363,341,326,301,313,281,271,259,274,253,244,224,199,213,229,187,206,173,198,183,188,163,153,145,156,120,137,130,122,125,107,124,109,105,123,104,105,95,102,88,99,87,95,74,93,71,71,76,66,67,61,59,65,68,55,49,59,62,49,48,65,54,60,52,57,41,44,63,49,41,35,41,41,38,35,37,44,42,41,46,30,38,32,36,26,28,28,33,30,28,25,23,22,20,22,31,26,19,19,19,23,15,23,15,20,18,13,23,17,17,17,18,16,13,22,16,16,16,17,18,21,14,12,17,15,13,17,22,12,11,13,18,11,7,6,15,17,12,8,7,10,12,7,10,13,9,10,7,7,10,4,10,8,5,14,4,6,8,6,9,4,8,7,8,7,5,10,8,9,7,5,9,5,4,3,6,4,7,6,5,6,5,3,6,5,4,5,5,6,2,6,11,4,2,7,3,3,5,3,3,4,2,7,3,2,6,2,3,5,2,4,3,4,5,3,4,1,7,1,3,1,4,4,1,3,4,3,2,6,5,1,1,3,4,1,2,5,1,2,1,5,1,2,5,2,1,2,1,2,4,3,4,1,1,3,1,6,1,2,2,3,1,4,1,1,4,4,3,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,1,1,1,1,1,2,2,1,2,1,2,1,2,1,1,4,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
