pdf('qc/rseqc/ML.DmBG3.c2.124-rep1.readdup.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,223,224,225,226,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,251,252,253,255,256,257,258,259,260,262,263,264,265,267,268,270,271,272,273,274,275,276,281,282,283,286,287,288,289,293,294,296,298,299,300,301,302,304,305,306,307,308,309,311,312,313,315,317,319,320,323,324,325,327,330,332,333,336,337,339,340,343,344,345,346,347,348,349,350,354,355,358,360,362,363,366,367,368,373,376,381,383,384,386,389,390,394,395,397,398,406,408,410,414,417,419,423,426,444,449,451,454,457,463,464,469,479,484,486,491,500,504,527,529,534,538,540,544,549,555,557,572,600,606,610,611,622,628,656,670,673,709,713,717,740,798,830,858,877,923,935,948,979,983,1025,1036,1047,1103,1182,1271,1361,1415,1418,1619,1921,2179,2237,3091,3129,3553,3571,8294)
seq_uniqRead=c(2988637,349713,118181,55181,30711,19173,13143,9431,7142,5500,4446,3727,3002,2583,2216,1965,1785,1598,1381,1297,1223,1163,1002,874,794,734,765,665,659,590,575,546,521,511,455,448,432,371,368,329,331,305,287,269,262,261,243,250,223,197,223,208,229,194,197,178,166,182,156,168,139,144,118,139,110,110,119,111,97,104,98,103,102,83,90,89,92,72,77,65,77,68,63,71,57,58,40,55,39,62,47,45,57,54,43,53,39,41,41,34,38,40,49,38,44,33,36,51,34,24,30,31,18,34,23,31,22,21,26,16,21,27,20,27,21,24,31,19,16,25,14,25,27,11,11,15,17,20,13,10,12,11,15,15,13,17,15,20,13,12,12,16,10,12,10,8,8,12,8,12,10,7,11,11,8,11,10,12,7,4,7,15,7,2,9,4,7,9,7,8,10,2,6,6,3,5,6,7,9,3,5,4,4,7,5,4,6,1,5,2,4,1,3,5,3,5,1,7,3,4,2,3,3,4,1,5,4,5,6,5,7,5,4,4,5,4,3,4,6,3,2,1,3,3,1,2,1,1,4,4,2,1,3,1,3,1,3,1,2,5,1,3,2,1,1,3,1,1,3,2,2,2,1,2,2,1,3,1,1,2,2,1,2,5,2,3,1,2,1,3,1,1,2,2,1,2,2,1,1,1,2,1,1,2,3,2,2,1,1,2,1,1,1,1,1,2,2,1,1,2,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,229,230,231,232,233,234,235,236,237,238,239,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,258,259,260,261,262,263,264,265,267,268,269,270,271,272,273,274,275,276,277,278,280,281,282,283,285,286,287,288,289,290,291,292,293,294,296,298,299,300,301,302,303,304,305,307,308,312,313,314,315,316,318,320,321,323,325,327,328,330,332,333,335,337,339,340,341,342,343,344,345,348,349,351,352,353,354,356,358,359,361,364,369,370,372,373,375,376,378,379,380,381,383,385,386,388,389,390,393,394,395,396,398,403,404,405,412,413,415,422,423,425,426,427,434,437,441,443,446,447,450,454,457,459,461,464,466,469,474,475,487,493,500,503,504,511,516,517,520,521,530,532,534,537,546,561,564,568,573,575,580,588,590,593,594,596,599,615,625,626,647,666,701,703,724,728,756,782,787,799,808,820,843,869,876,941,976,1076,1089,1103,1133,1143,1153,1183,1185,1347,1476,1539,1620,1635,1862,2166,2466,2597,3593,3602,4096,4158,10221)
pos_uniqRead=c(2163538,405019,144556,69038,38952,24278,16461,11963,8968,7142,5505,4499,3838,3275,2760,2381,2019,1937,1676,1557,1359,1287,1177,1117,1039,929,896,792,706,688,630,648,568,588,519,545,480,426,454,415,416,383,378,336,326,320,298,310,273,256,272,224,274,242,222,195,212,183,183,195,188,182,178,157,156,162,144,143,152,142,119,120,110,131,134,111,100,89,96,116,108,101,89,82,75,76,75,74,80,78,66,78,62,66,57,57,48,65,54,49,71,49,48,61,53,41,40,50,41,42,42,38,35,41,32,38,40,35,33,34,30,31,35,35,31,31,30,32,33,35,25,31,26,25,17,25,22,19,23,21,26,13,24,19,15,24,17,10,23,14,16,18,23,16,12,12,29,17,16,16,20,13,11,16,18,10,10,16,13,15,9,11,12,13,11,13,10,5,15,7,9,6,13,13,9,10,9,9,9,5,4,10,3,13,12,5,4,4,5,8,7,10,5,10,7,9,7,6,7,7,7,7,4,6,6,3,4,5,4,5,7,7,7,7,4,4,7,7,5,4,3,5,6,7,3,2,4,3,6,3,3,4,2,6,2,3,1,3,5,5,4,4,4,2,8,3,5,4,6,3,4,1,2,1,2,2,3,4,6,4,1,4,3,2,1,1,2,2,3,2,1,5,3,1,2,2,2,3,1,2,1,3,1,1,1,1,2,1,2,3,2,2,1,2,1,2,1,2,1,1,1,1,2,5,1,3,1,1,1,1,2,4,1,4,1,2,2,1,1,2,1,1,2,1,4,1,2,1,1,2,2,2,1,1,1,2,4,1,1,1,2,1,1,2,1,3,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,2,1,2,1,3,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
